OPT = {"activation": "gelu",
"adafactor_eps": '[1e-30, 0.001]',
"adam_eps": 1e-08,
"add_cleaned_reply_to_history": False,
"add_p1_after_newln": False,
"allow_missing_init_opts": False,
"attention_dropout": 0.0,
"batchsize": 1, #BATCH SIZE
"beam_block_full_context": False, #Here beam search is used for inference
"beam_block_list_filename": None,
"beam_block_ngram": 3,
"beam_context_block_ngram": 3,
"beam_delay": 30,
"beam_length_penalty": 0.65,
"beam_min_length": 20,
"beam_size": 10,
"betas": '[0.9, 0.999]',
"bpe_add_prefix_space": None,
"bpe_debug": False,
"bpe_dropout": None,
"bpe_merge": "./ParlAI/data/models/msc/summsc_fidrag3B/model.dict-merges.txt",
"bpe_vocab": "./ParlAI/data/models/msc/summsc_fidrag3B/model.dict-vocab.json",
"candidates": "inline",
"cap_num_predictions": 100,
"checkpoint_activations": False,
"codes_attention_num_heads": 4,
"codes_attention_type": "basic",
"compressed_indexer_factory": "IVF4096_HNSW128,PQ128",
"compressed_indexer_gpu_train": False,
"compressed_indexer_nprobe": 64,
"compute_tokenized_bleu": False,
"converting": False,
"data_parallel": False,
"datapath": "data",
"datatype": "train",
"debug":True,
"delimiter": '\n',
"dict_class": "parlai.core.dict:DictionaryAgent",
"dict_endtoken": "__end__",
"dict_file": "data/models/msc/summsc_fidrag3B/model.dict",
"dict_initpath": None,
"dict_language": "english",
"dict_loaded": True,
"dict_lower": False,
"dict_max_ngram_size": -1,
"dict_maxtokens": -1,
"dict_minfreq": 0,
"dict_nulltoken": "__null__",
"dict_starttoken": "__start__",
"dict_textfields": "text,labels",
"dict_tokenizer": "bytelevelbpe",
"dict_unktoken": "__unk__",
"display_examples": False,
"display_prettify": False,
"doc_chunk_split_mode": "word",
"doc_chunks_ranker": "head",
"download_path": None,
"dpr_model_file": "zoo:msc/summsc_rag3B/model",
"dpr_num_docs": 25,
"dropout": 0.1,
"dynamic_batching": None,
"embedding_projection": "random",
"embedding_size": 2560,
"embedding_type": "random",
"embeddings_scale": True,
"encode_candidate_vecs": True,
"encode_candidate_vecs_batchsize": 256,
"eval_candidates": "inline",
"ffn_size": 10240,
"fid_ddp_compatible": True,
"fixed_candidate_vecs": "reuse",
"fixed_candidates_path": None,
"force_fp16_tokens": True,
"fp16": True,
"fp16_impl": "mem_efficient",
"generation_model": "transformer_variant/generator",
"gold_document_key": "__selected-docs__",
"gold_document_titles_key": "select-docs-titles",
"gold_knowledge_passage_key": "checked_sentence",
"gold_knowledge_title_key": "title",
"gold_sentence_key": "__selected-sentences__",
"gpu": -1,
"gradient_clip": 0.1,
"hide_labels": False,
"history_add_global_end_token": "end",
"history_reversed": False,
"history_size": -1, #IMPORTANT (number of sequences in history)
"hnsw_ef_construction": 200,
"hnsw_ef_search": 128,
"hnsw_indexer_store_n": 128,
"ignore_bad_candidates": False,
"image_cropsize": 224,
"image_mode": "raw",
"image_size": 256,
"indexer_buffer_size": 65536,
"indexer_type": "compressed",
"inference": "beam", #Inference method
"init_model": None,
"init_opt": None,
"insert_gold_docs": False,
"interactive_candidates": "fixed",
"interactive_mode": True,
"interactive_task": True,
"invsqrt_lr_decay_gamma": -1,
"is_debug": True, #Debug level
"knowledge_access_method": "memory_only",
"label_truncate": 128,
"learn_embeddings": True,
"learn_positional_embeddings": False,
"learningrate": 7e-06,
"local_human_candidates_file": None,
"log_keep_fields": all,
"loglevel": "debug", #info for normal usage, debug to debug
"lr_scheduler": "reduceonplateau",
"lr_scheduler_decay": 0.5,
"lr_scheduler_patience": 3,
"max_doc_token_length": 128,
"max_memories": 20,
"memory_attention": "sqrt",
"memory_decoder_beam_min_length": 10,
"memory_decoder_beam_size": 3,
"memory_decoder_delimiter": '\n',
"memory_decoder_ignore_phrase": "persona:",
"memory_decoder_key": "full_text",
"memory_decoder_model_file": None,
"memory_decoder_one_line_memories": False,
"memory_decoder_truncate": -1,
"memory_delimiter": None,
"memory_doc_delimiter": ":",
"memory_doc_title_delimiter": ":",
"memory_extractor_phrase": 'persona:', #default None
"memory_extractor_phrases": "persona:,__his__",
"memory_key": "full_text",  #full_text or personas
"memory_reader_model": None,
"memory_retriever_truncate": -1,
"memory_writer_model": "bert",
"memory_writer_model_file": "zoo:hallucination/multiset_dpr/hf_bert_base.cp",
"min_doc_token_length": 128,
"max_doc_token_length": 256,
"model": "projects.msc.agents.memory_agent:MemoryLongFidAgent",
#"model_file": "./ParlAI/data/models/msc/summsc_fidrag3B/model",
"model_parallel": True,
"momentum": 0,
"multitask_weights": '[4.0, 2.0, 2.0, 1.0]',
"n_decoder_layers": 24,
"n_docs": 3,
"n_encoder_layers": 2,
"n_extra_positions": 0,
"n_heads": 32,
"n_layers": 2,
"n_positions": 1024,
"n_positions_init": 128,
"n_ranked_doc_chunks": 1,
"n_segments": 0,
"nesterov": True,
"no_cuda": False, #Don't use GPU or use it 
"normalize_sent_emb": False,
"nus": [0.7],
"optimizer": "mem_eff_adam",
"output_scaling": 1.0,
"override": {'model_file': 'data/models/msc/summsc_fidrag3B/model'},
"parlai_home": "/private/home/jingxu23/ParlAI",
"path_to_dense_embeddings": None,
"path_to_dpr_passages": "zoo:hallucination/wow_passages/wow_articles.paragraphs.tsv",
"path_to_index": "zoo:hallucination/wow_passages/compressed",
"person_tokens": False,
"poly_attention_num_heads": 4,
"poly_attention_type": "basic",
"poly_faiss_model_file": None,
"poly_n_codes": 64,
"poly_score_initial_lambda": 0.5,
"polyencoder_init_model": "wikito",
"polyencoder_type": "codes",
"print_docs": False,
"query_generator_beam_min_length": 2,
"query_generator_beam_size": 3,
"query_generator_delimiter": '\n',
"query_generator_ignore_phrase": "persona:",
"query_generator_inference": "beam",
"query_generator_key": "full_text",
"query_generator_model_file": "null",
"query_generator_truncate": -1,
"query_model": "bert_from_parlai_rag",
"rag_model_type": "token",
"rag_query_truncate": 512,
"rag_retriever_query": "full_history",
"rag_retriever_type": "dpr",
"rag_turn_discount_factor": 1.0,
"rag_turn_marginalize": "doc_then_turn",
"rag_turn_n_turns": 2,
"rank_candidates": False,
"rank_top_k": -1,
"reduction_type": "mean",
"regret": False,
"regret_dict_file": None,
"regret_intermediate_maxlen": 32,
"regret_model_file": None,
"regret_override_index": False,
"relu_dropout": 0.0,
"repeat_blocking_heuristic": True,
"retriever_debug_index": "compressed",
"retriever_delimiter": '\n',
"retriever_embedding_size": 768,
"retriever_ignore_phrase": None,
"retriever_ignore_phrases": "persona:,__his__",
"return_cand_scores": False,
"save_format": "conversations",
"search_query_generator_beam_min_length": 2,
"search_query_generator_beam_size": 3,
"search_query_generator_inference": "greedy",
"search_query_generator_model_file": None,
"search_query_generator_text_truncate": 512,
"search_server": None,
"share_encoders": True,
"share_search_and_memory_query_encoder": False,
"share_word_embeddings": True,
"single_turn": False,
"skip_generation": False,
"skip_search_key": "skip_search",
"special_tok_lst": None,
"split_lines": False,
"splitted_chunk_length": 100,
"starttime": "Jun26_11-20",
"t5_dropout": 0.0,
"t5_generation_config": None,
"t5_model_arch": "t5-base",
"t5_model_parallel": False,
"task": "convai2:normalized,internal:personal_knowledge:previous_persona_type=both:session_id=1,internal:personal_knowledge:previous_persona_type=both:session_id=2,internal:personal_knowledge:previous_persona_type=both:session_id=3",
#"task": "msc",
"temperature": 1.0, #Temperature for randomness in sampling
"text_truncate": 1024,
"tfidf_max_doc_paragraphs": -1,
"tfidf_model_path": "zoo:wikipedia_full/tfidf_retriever/model",
"thorough": False,
"topk": 10,
"topp": 0.9,
"train_predict": False,
"truncate": 1024,
"update_freq": 4,
"use_memories": True, #Use memories or not (default False)
"use_reply": "label",
"variant": "prelayernorm",
"verbose": False,
"warmup_rate": 0.0001,
"warmup_updates": 200,
"weight_decay": None,
"woi_doc_chunk_size": 500,
"wrap_memory_encoder": False}